<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Panel de Revisi贸n de Proyectos</title>

  <!-- Bootstrap + Icons + Chart.js -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    :root {
      --bg: #0b1220;
      --panel: #0e1a34;
      --accent: #4fd1ff;
      --muted: #9fb7d1;
    }
    body {
      background: var(--bg);
      color: #e6f2ff;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      padding-top: 70px;
    }
    .navbar {
      background: linear-gradient(90deg, #071025, #0e1a34);
      border-bottom: 1px solid rgba(79,209,255,0.1);
    }
    .navbar-brand {
      color: var(--accent) !important;
      font-weight: 700;
    }
    .nav-link { color: #e6f2ff !important; margin-right: 15px; }
    .nav-link:hover { color: var(--accent) !important; }

    .panel {
      background: var(--panel);
      border: 1px solid rgba(79,209,255,.12);
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 1rem;
    }

    .stat-card {
      background: transparent;
      border: 1px solid rgba(79,209,255,.06);
      border-radius: 10px;
      padding: 12px;
    }

    .table thead th {
      background: #0f244a;
      color: #aad7ff;
      border-color: #123058;
    }

    .form-control, .form-select {
      background: #071a2b;
      color: #e6f2ff;
      border: 1px solid #16314a;
    }

    .modal-content {
      background: var(--panel);
      color: #e6f2ff;
      border: 1px solid rgba(79,209,255,.18);
    }

    .btn-primary {
      background: #17a2ff;
      border-color: #17a2ff;
    }

    .small-muted {
      color: var(--muted);
      font-size: .85rem;
    }

    iframe {
      border-radius: 8px;
      width: 100%;
      height: 500px;
      background: #0b162f;
    }

    /* Estilos para impresi贸n */
    @media print {
      .navbar, .btn, .no-print { display: none !important; }
      body { background: white; color: black; }
      table { color: black !important; }
    }
  </style>
</head>

<body>
  <!--  NAVBAR SUPERIOR -->
  <nav class="navbar navbar-expand-lg fixed-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="#"><i class="bi bi-clipboard2-check"></i> EvalPro</a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item"><a class="nav-link" href="#dashboard">Dashboard</a></li>
          <li class="nav-item"><a class="nav-link" href="#proyectos">Proyectos</a></li>
          <li class="nav-item"><a class="nav-link" href="#reportes">Reportes</a></li>
          <li class="nav-item"><a class="nav-link" href="#exportar">Exportar</a></li>
        </ul>

        <div class="d-flex align-items-center">
          <div class="text-end me-2 d-none d-sm-block">
            <div class="small-muted">Usuario</div>
            <div class="fw-bold">Evaluador</div>
          </div>
          <div class="rounded-circle bg-info text-dark d-flex align-items-center justify-content-center" style="width:40px;height:40px;">
            <i class="bi bi-person-fill"></i>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!--  DASHBOARD -->
  <div class="container-fluid p-3" id="dashboard">
    <div class="row g-3 mb-3">
      <div class="col-md-4">
        <div class="stat-card text-center">
          <i class="bi bi-hourglass-split fs-3 text-warning"></i>
          <div class="small-muted">Pendientes</div>
          <div id="countPendientes" class="h4 text-warning">3</div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="stat-card text-center">
          <i class="bi bi-check-circle fs-3 text-success"></i>
          <div class="small-muted">Aprobados</div>
          <div id="countAprobados" class="h4 text-success">5</div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="stat-card text-center">
          <i class="bi bi-x-circle fs-3 text-danger"></i>
          <div class="small-muted">Desaprobados</div>
          <div id="countDesaprobados" class="h4 text-danger">2</div>
        </div>
      </div>
    </div>

    <!--  Tabla de Proyectos -->
    <div class="panel" id="proyectos">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <div>
          <strong>Proyectos Enviados</strong>
          <div class="small-muted">Lista de proyectos por revisar</div>
        </div>
        <div class="d-flex gap-2">
          <input id="buscar" class="form-control form-control-sm" placeholder="Buscar proyecto">
          <select id="filtroEstado" class="form-select form-select-sm">
            <option value="">Todos</option>
            <option value="pendiente">Pendiente</option>
            <option value="aprobado">Aprobado</option>
            <option value="desaprobado">Desaprobado</option>
          </select>
        </div>
      </div>

      <div class="table-responsive">
        <table class="table table-hover table-sm align-middle mb-0">
          <thead>
            <tr>
              <th>T铆tulo</th><th>Docente</th><th>Fecha</th><th>Archivo</th><th>Estado</th><th>Acci贸n</th>
            </tr>
          </thead>
          <tbody id="tbodyProyectos"></tbody>
        </table>
      </div>
    </div>

    <!--  REPORTES -->
    <div class="panel" id="reportes">
      <h5>Reportes Generales</h5>
      <div class="row">
        <div class="col-lg-6">
          <canvas id="chartEstados" height="200"></canvas>
        </div>
        <div class="col-lg-6">
          <table class="table table-sm mb-0">
            <thead><tr><th>Proyecto</th><th>Evaluador</th><th>Fecha</th><th>Estado</th></tr></thead>
            <tbody id="tbodyReportes"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!--  EXPORTAR E IMPRIMIR -->
    <div class="panel" id="exportar">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h5 class="mb-0"><i class="bi bi-file-earmark-arrow-down"></i> Exportar / Imprimir Reporte General</h5>
      </div>
      <div class="text-end mb-3">
        <button class="btn btn-outline-light btn-sm me-2 no-print" onclick="exportarCSV()">
          <i class="bi bi-filetype-csv"></i> Exportar CSV
        </button>
        <button class="btn btn-outline-info btn-sm me-2 no-print" onclick="imprimirReporte()">
          <i class="bi bi-printer"></i> Imprimir
        </button>
      </div>

      <div class="table-responsive">
        <table id="tablaExport" class="table table-bordered table-sm text-light">
          <thead>
            <tr><th>T铆tulo</th><th>Docente</th><th>Fecha</th><th>Archivo</th><th>Estado</th></tr>
          </thead>
          <tbody id="tbodyExport"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!--  MODAL DE EVALUACIN -->
  <div class="modal fade" id="modalEvaluar" tabindex="-1">
    <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Evaluar Proyecto</h5>
          <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-7">
              <iframe id="visorArchivo"></iframe>
            </div>
            <div class="col-md-5">
              <form id="formEvaluacion">
                <div class="mb-2">
                  <label class="form-label">Claridad del Contenido</label>
                  <select class="form-select" name="claridad">
                    <option>Excelente</option><option>Buena</option><option>Regular</option><option>Deficiente</option>
                  </select>
                </div>
                <div class="mb-2">
                  <label class="form-label">Relevancia del Proyecto</label>
                  <select class="form-select" name="relevancia">
                    <option>Alta</option><option>Media</option><option>Baja</option>
                  </select>
                </div>
                <div class="mb-2">
                  <label class="form-label">Cumplimiento de Requisitos</label>
                  <select class="form-select" name="cumplimiento">
                    <option>Completo</option><option>Parcial</option><option>Insuficiente</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label class="form-label">Observaciones</label>
                  <textarea class="form-control" name="observaciones" rows="4"></textarea>
                </div>
                <div class="text-end">
                  <button type="button" class="btn btn-success btn-sm me-1">Aprobar</button>
                  <button type="button" class="btn btn-danger btn-sm">Rechazar</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!--  SCRIPT -->
  <script>
    const proyectos = [
      { titulo: "Sistema de Gesti贸n Escolar", docente: "Luis Paredes", fecha: "2025-10-01", archivo: "proyecto1.pdf", estado: "pendiente" },
      { titulo: "App de Reciclaje", docente: "Carla G贸mez", fecha: "2025-09-25", archivo: "proyecto2.pdf", estado: "aprobado" },
      { titulo: "Plataforma de Cursos", docente: "Miguel Torres", fecha: "2025-09-18", archivo: "proyecto3.pdf", estado: "desaprobado" },
    ];

    function renderProyectos() {
      const tbody = document.getElementById("tbodyProyectos");
      const tbodyExport = document.getElementById("tbodyExport");
      const tbodyReportes = document.getElementById("tbodyReportes");
      tbody.innerHTML = tbodyExport.innerHTML = tbodyReportes.innerHTML = "";

      proyectos.forEach(p => {
        const estadoColor = p.estado === "aprobado" ? "success" : p.estado === "desaprobado" ? "danger" : "warning";
        tbody.innerHTML += `
          <tr>
            <td>${p.titulo}</td>
            <td>${p.docente}</td>
            <td>${p.fecha}</td>
            <td><a href="${p.archivo}" target="_blank">Ver</a></td>
            <td><span class="badge bg-${estadoColor}">${p.estado}</span></td>
            <td><button class="btn btn-sm btn-outline-info" onclick="abrirEvaluacion('${p.archivo}')"><i class="bi bi-search"></i></button></td>
          </tr>`;
        tbodyExport.innerHTML += `
          <tr><td>${p.titulo}</td><td>${p.docente}</td><td>${p.fecha}</td><td>${p.archivo}</td><td>${p.estado}</td></tr>`;
        tbodyReportes.innerHTML += `
          <tr><td>${p.titulo}</td><td>Evaluador</td><td>${p.fecha}</td><td>${p.estado}</td></tr>`;
      });
    }

    function abrirEvaluacion(archivo) {
      document.getElementById("visorArchivo").src = archivo;
      new bootstrap.Modal(document.getElementById("modalEvaluar")).show();
    }

    function renderChart() {
      const ctx = document.getElementById("chartEstados");
      new Chart(ctx, {
        type: "doughnut",
        data: {
          labels: ["Pendientes", "Aprobados", "Desaprobados"],
          datasets: [{ data: [3,5,2], backgroundColor: ["#ffc107","#198754","#dc3545"] }]
        }
      });
    }

    function exportarCSV() {
      let csv = "T铆tulo,Docente,Fecha,Archivo,Estado\n";
      proyectos.forEach(p => csv += `${p.titulo},${p.docente},${p.fecha},${p.archivo},${p.estado}\n`);
      const blob = new Blob([csv], { type: "text/csv" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "reporte_proyectos.csv";
      link.click();
    }

    function imprimirReporte() {
      window.print();
    }

    renderProyectos();
    renderChart();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
